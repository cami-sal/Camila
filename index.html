<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Population Growth (UNESCO)</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      margin: 0;
      background: #fff9c4; /* light yellow */
      font-family: sans-serif;
    }
    svg {
      width: 100vw;
      height: 95vh;
    }
    .line {
      fill: none;
      stroke-width: 2px;
      opacity: 0.8;
      cursor: pointer;
    }
    .line:hover {
      stroke-width: 4px;
      opacity: 1;
    }
    .axis path, .axis line {
      stroke: #555;
    }
    #tooltip {
      position: absolute;
      font-size: 28px;
      font-weight: bold;
      color: #222;
      text-shadow: 0 1px 1px #fff;
      pointer-events: none;
      display: none;
    }
  </style>
</head>
<body>
  <svg></svg>
  <div id="tooltip"></div>
  <script>
    // Embed the JSON data directly:
    const raw = {
      "records": [
        {"geoUnit":"ARG","year":2015,"value":1.1},
        {"geoUnit":"ARG","year":2016,"value":1.0},
        {"geoUnit":"ARG","year":2017,"value":0.9},
        {"geoUnit":"CHL","year":2015,"value":1.2},
        {"geoUnit":"CHL","year":2016,"value":1.1},
        {"geoUnit":"CHL","year":2017,"value":1.0},
        {"geoUnit":"KOR","year":2015,"value":0.5},
        {"geoUnit":"KOR","year":2016,"value":0.4},
        {"geoUnit":"KOR","year":2017,"value":0.3}
        // ðŸ‘‰ aquÃ­ sigue todo tu JSON (pega todos los registros)
      ]
    };

    const records = raw.records;

    const svg = d3.select("svg");
    const width = svg.node().clientWidth;
    const height = svg.node().clientHeight;
    const margin = {top: 40, right: 30, bottom: 40, left: 60};
    const innerWidth = width - margin.left - margin.right;
    const innerHeight = height - margin.top - margin.bottom;

    const g = svg.append("g").attr("transform", `translate(${margin.left},${margin.top})`);

    const years = Array.from(new Set(records.map(d => d.year))).sort((a,b) => a-b);

    const x = d3.scaleLinear()
      .domain(d3.extent(years))
      .range([0, innerWidth]);

    const y = d3.scaleLinear()
      .domain([
        d3.min(records, d => d.value) - 0.5,
        d3.max(records, d => d.value) + 0.5
      ])
      .nice()
      .range([innerHeight, 0]);

    const xAxis = d3.axisBottom(x).ticks(years.length).tickFormat(d3.format("d"));
    const yAxis = d3.axisLeft(y);

    g.append("g")
      .attr("transform", `translate(0,${innerHeight})`)
      .call(xAxis);

    g.append("g").call(yAxis);

    const line = d3.line()
      .x(d => x(d.year))
      .y(d => y(d.value));

    const dataByCountry = d3.group(records, d => d.geoUnit);
    const color = d3.scaleOrdinal(d3.schemeCategory10).domain(Array.from(dataByCountry.keys()));

    g.selectAll(".line")
      .data(dataByCountry)
      .join("path")
      .attr("class", "line")
      .attr("stroke", ([id]) => color(id))
      .attr("d", ([id, values]) => line(values.sort((a,b) => a.year-b.year)))
      .on("mousemove", (event, [id]) => {
        const tooltip = document.getElementById("tooltip");
        tooltip.style.display = "block";
        tooltip.style.left = (event.pageX) + "px";
        tooltip.style.top = (event.pageY - 40) + "px";
        tooltip.textContent = id;
      })
      .on("mouseout", () => {
        document.getElementById("tooltip").style.display = "none";
      });
  </script>
</body>
</html>
